<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FISH ＜＞＜ COMMUNITY - VRChat Colors, Roboto Font, Readability Optimized</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* --- Base Styles --- */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #121212;
            color: #e0e0e0;
            margin: 0;
            padding: 20px 0;
            overflow-x: hidden;
            line-height: 1.7;
        }

        .container {
            width: 90%;
            max-width: 850px;
            margin: 40px auto;
            padding: 20px;
            background-color: #1e1e1e;
            border-radius: 5px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            text-align: left;
            overflow: hidden;
            position: relative;
        }
        @media (min-width: 600px) {
            .container {
                width: 80%;
                padding: 40px;
            }
        }

        h1, h2, h3 {
            font-weight: bold;
            text-align: left;
        }

        /* Gradient Animation for H1 and H2 */
        h1, h2 {
            --gradient-angle: 120deg;
            background: linear-gradient(
                var(--gradient-angle),
                #00bcd4, #ff4081, #4caf50, #ffc107, #00bcd4
            );
            background-size: 300% 300%;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            animation: gradientFlow 8s ease infinite;
            font-weight: bold;
            text-align: left;
        }
        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        h1 {
            font-size: 2.4em; letter-spacing: -0.02em; margin-bottom: 30px;
        }
         @media (min-width: 600px) { h1 { font-size: 2.8em; margin-bottom: 35px; } }

        h2 {
            font-size: 1.8em; margin-top: 40px; margin-bottom: 20px;
        }
        @media (min-width: 600px) { h2 { font-size: 2em; margin-top: 50px; margin-bottom: 25px; } }

        h3 {
            font-size: 1.3em; margin-top: 30px; margin-bottom: 15px; color: #bbbbbb;
        }
        @media (min-width: 600px) { h3 { font-size: 1.4em; margin-top: 35px; } }

        p, ul, ol {
            font-size: 1.05em; line-height: 1.7; margin-bottom: 20px; color: #d0d0d0;
        }
        @media (min-width: 600px) { p, ul, ol { font-size: 1.15em; line-height: 1.8; margin-bottom: 25px; } }

        ul, ol { padding-left: 30px; }
        @media (min-width: 600px) { ul, ol { padding-left: 35px; } }

        li { margin-bottom: 10px; }
         @media (min-width: 600px) { li { margin-bottom: 12px; } }

        a { color: #4dd0e1; text-decoration: underline; transition: color 0.2s ease; }
        a:hover { color: #00e5ff; }

        .warning { color: #ffc107; font-weight: bold; }

        hr { border: 0; border-top: 1px solid #4dd0e1; margin: 40px 0; }
        @media (min-width: 600px) { hr { margin: 50px 0; } }

        .fish-animation {
            white-space: nowrap; font-size: 3em; color: #4dd0e1; display: block;
            animation: fishSwim 15s linear infinite; width: 100%; overflow: hidden;
            box-sizing: border-box; margin-bottom: 30px; text-align: left; padding-left: 100%;
        }
        @media (min-width: 600px) {
            .fish-animation { font-size: 4em; display: inline-block; width: auto; margin-bottom: 40px; padding-left: 100%; }
        }
        @keyframes fishSwim { 0% { transform: translateX(0); } 100% { transform: translateX(-200%); } }
        .fish-symbol { display: inline-block; color: #4dd0e1; }
        .fish-symbol:nth-child(5n+1) { animation-delay: 0s; }
        .fish-symbol:nth-child(5n+2) { animation-delay: 0.2s; }
        .fish-symbol:nth-child(5n+3) { animation-delay: 0.4s; }
        .fish-symbol:nth-child(5n+4) { animation-delay: 0.6s; }
        .fish-symbol:nth-child(5n+5) { animation-delay: 0.8s; }

        .community-image, .meaning-image {
            max-width: 100%; height: auto; display: block; margin: 20px auto;
            border-radius: 5px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        .meaning-image { max-width: 90%; margin-top: 30px; margin-bottom: 30px; }
         @media (min-width: 768px) { .meaning-image { max-width: 600px; } }

        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; margin: 20px 0; }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 5px; }

        /* Theme Styles */
        .fish-verified-theme p, .fish-verified-theme li, .fish-verified-theme h3, .fish-verified-theme ol { color: #FFFFFF; }
        .fish-verified-theme a { color: #A7D8FF; }
        .fish-verified-theme a:hover { color: #D0EFFF; }
        .fish-verified-theme h3 { color: #F0F0F0 !important; } /* Use !important cautiously */
        .fish-verified-theme ol li::marker { color: #FFFFFF; }

        .luxury-trash-theme p, .luxury-trash-theme li, .luxury-trash-theme h3 { color: #FFD700; }
        .luxury-trash-theme a { color: #FFEC8B; }
        .luxury-trash-theme a:hover { color: #FFFACD; }
        .luxury-trash-theme h3 { color: #FBC02D !important; } /* Use !important cautiously */
        .luxury-trash-theme p i { color: #FFEA00; } /* Style for italic text in luxury trash */

        .rose-fish-theme p, .rose-fish-theme li, .rose-fish-theme h3, .rose-fish-theme ol { color: #FF6B6B; }
        .rose-fish-theme a { color: #FF8F8F; }
        .rose-fish-theme a:hover { color: #FFBDBD; }
        .rose-fish-theme h3 { color: #E57373 !important; } /* Use !important cautiously */
        .rose-fish-theme ol li::marker { color: #FF6B6B; }


        /* === CALENDAR STYLES ===================== */

        :root {
            --cal-bg-color: #1a1a1e;
            --cal-header-bg: #222226;
            --cal-border-color: #333337;
            --cal-text-color: #e0e0e0;
            --cal-dim-text-color: #777;

            /* Pink Primary, Blue Secondary */
            --cal-primary-color: #FF69B4;
            --cal-secondary-color: #00BFFF;

            --cal-today-border: var(--cal-primary-color);
            --cal-event-color: var(--cal-secondary-color);
            --cal-event-num-color: #b0c4de; /* Used for ordinal event number */

            --cal-button-bg: var(--cal-primary-color);
            --cal-button-text: #111;
            --cal-button-hover-bg: #ff4fa4;
            --cal-today-button-bg: var(--cal-secondary-color);
            --cal-today-button-hover-bg: #009acd;
        }

        .calendar-container {
            background-color: var(--cal-bg-color);
            border-radius: 8px;
            padding: 15px;
            margin-top: 30px;
            margin-bottom: 10px; /* Space between calendar and first timer */
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);
            border: 1px solid var(--cal-border-color);
        }
        @media (min-width: 600px) { .calendar-container { padding: 20px; } }

        .calendar-header {
            display: flex; align-items: center; justify-content: space-between;
            padding: 10px 5px; background-color: var(--cal-header-bg);
            border-radius: 6px 6px 0 0; margin: -15px -15px 10px -15px; position: relative; /* Adjust negative margins based on padding */
        }
        @media (min-width: 600px) { .calendar-header { padding: 12px 15px; margin: -20px -20px 15px -20px; } }

        /* Override gradient text for calendar header H3 */
        .calendar-header h3#cal-month-year {
            margin: 0; font-size: 1.3em; font-weight: bold; text-align: center; flex-grow: 1;
            /* Reset gradient styles */
            background: none !important;
            -webkit-background-clip: initial !important;
            background-clip: initial !important;
            color: var(--cal-text-color) !important;
            -webkit-text-fill-color: initial !important;
            animation: none !important;
        }
        @media (min-width: 600px) { .calendar-header h3#cal-month-year { font-size: 1.5em; } }

        .cal-nav-btn, .cal-today-btn {
            border: none; border-radius: 5px; padding: 6px 12px; font-size: 1em; font-weight: bold;
            cursor: pointer; transition: background-color 0.2s ease; line-height: 1; color: var(--cal-button-text);
        }
        .cal-nav-btn { background-color: var(--cal-button-bg); }
        .cal-nav-btn:hover { background-color: var(--cal-button-hover-bg); }
        .cal-today-btn { background-color: var(--cal-today-button-bg); margin-left: 10px; }
        .cal-today-btn:hover { background-color: var(--cal-today-button-hover-bg); }

        /* Responsive positioning for 'Today' button */
        @media (max-width: 480px) {
            .cal-today-btn { position: absolute; bottom: -45px; right: 5px; margin-left: 0; }
            .calendar-header { padding-bottom: 5px; } /* Ensure content isn't cut off */
            #start-day-controls { margin-bottom: 45px; } /* Make space for absolute positioned button */
            .calendar-weekdays { margin-top: 45px; } /* Adjust space if needed */
        }

        #start-day-controls {
            text-align: center;
            margin-bottom: 10px;
            margin-top: 0px;
            display: flex;
            justify-content: center; align-items: center; gap: 8px; flex-wrap: wrap;
            padding: 5px 15px 10px 15px; border-bottom: 1px solid var(--cal-border-color);
            margin-left: -15px; margin-right: -15px; /* Align with container padding */
        }
        @media (min-width: 600px) {
            #start-day-controls { margin-left: -20px; margin-right: -20px; padding-left: 20px; padding-right: 20px; }
        }

        .start-day-label { font-size: 0.9em; color: var(--cal-text-color); margin-right: 5px; }

        .cal-start-day-btn {
            background-color: #3a3a3a; color: #cccccc; border: 1px solid #555;
            padding: 4px 10px; border-radius: 4px; cursor: pointer; font-size: 0.85em;
            transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
        }
        .cal-start-day-btn:hover { background-color: #4a4a4a; border-color: #777; }
        .cal-start-day-btn.active {
            background-color: var(--cal-primary-color); color: var(--cal-button-text);
            border-color: var(--cal-primary-color); font-weight: bold;
        }

        /* Weekday Header Styles */
        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            padding-bottom: 8px;
            margin-bottom: 8px;
            border-bottom: 1px solid var(--cal-border-color);
            margin-left: -15px; margin-right: -15px; /* Align with container padding */
            padding-left: 15px; padding-right: 15px; /* Inner padding for content */
        }
        @media (min-width: 600px) {
            .calendar-weekdays {
                margin-left: -20px;
                margin-right: -20px;
                padding-left: 20px;
                padding-right: 20px;
            }
        }

        .weekday-header {
            text-align: center;
            font-weight: bold;
            font-size: 0.85em;
            color: var(--cal-dim-text-color);
            padding: 4px 0;
            text-transform: uppercase;
        }
        @media (min-width: 600px) {
            .weekday-header {
                font-size: 0.9em;
            }
        }


        .calendar-body {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        /* Calendar Day Cell Styles */
        .calendar-day {
            background-color: var(--cal-header-bg); border: 1px solid var(--cal-border-color);
            border-radius: 4px; padding: 5px; min-height: 75px; display: flex;
            flex-direction: column; align-items: center; justify-content: flex-start; /* Align content to top */
            font-size: 0.85em; cursor: default; transition: background-color 0.2s ease;
            overflow: hidden; position: relative; text-align: center;
        }
        @media (min-width: 600px){ .calendar-day { min-height: 85px; font-size: 0.9em; padding: 8px 5px; } }

        /* Link inside calendar day */
        .calendar-day a {
            color: inherit; /* Inherit text color from parent */
            text-decoration: none; /* Remove underline from link */
            display: flex;
            flex-direction: column; /* Stack elements vertically */
            align-items: center;    /* Center horizontally */
            justify-content: flex-start; /* Align to top */
            height: 100%; /* Fill the cell */
            width: 100%;
            padding: inherit; /* Use padding from parent .calendar-day (applied effectively via box-sizing) */
            box-sizing: border-box; /* Include padding in width/height */
        }
        .calendar-day a:hover {
            color: inherit; /* Keep color consistent on hover, rely on parent hover effect */
        }


        .calendar-day:hover { background-color: #303034; } /* Hover effect for the cell */

        /* Styles for days not in the current month */
        .calendar-day.other-month { background-color: transparent; border-color: transparent; cursor: default; }
        .calendar-day.other-month .day-number { color: var(--cal-dim-text-color); opacity: 0.6; }
        .calendar-day.other-month .event-location,
        .calendar-day.other-month .daily-event-num { display: none; } /* Hide event details */
        .calendar-day.other-month:hover { background-color: transparent; } /* No hover effect */

        /* Style for today's date */
        .calendar-day.today { border: 2px solid var(--cal-today-border); background-color: #2a2a30; }
        .calendar-day.today .day-number { font-weight: bold; color: var(--cal-primary-color); }

        /* Style for the Day Number (Top) */
        .calendar-day .day-number {
            font-size: 1.1em; /* Relatively large */
            color: var(--cal-text-color);
            margin-top: 0px;    /* Position at the very top */
            margin-bottom: 2px; /* Small space below */
            line-height: 1.1;
            display: block;     /* Ensure it takes its own line */
        }

        /* Style for the Ordinal Event Number (Middle) */
        .calendar-day .daily-event-num {
            font-size: 0.8em;  /* Smaller than day number */
            color: var(--cal-event-num-color); /* Dimmer color */
            margin-top: 1px;    /* Small space above */
            margin-bottom: 1px; /* Small space below */
            line-height: 1;
            font-weight: normal;
            opacity: 0.9;
            display: block;     /* Ensure it takes its own line */
        }

        /* Style for the Event Location (Bottom) */
        .calendar-day .event-location {
            font-size: 0.9em;   /* Medium size */
            color: var(--cal-event-color); /* Brighter event color */
            font-weight: bold;
            margin-top: 1px;    /* Small space above */
            margin-bottom: 0px; /* No extra space at the bottom */
            line-height: 1;
            word-break: break-word; /* Prevent long locations from overflowing */
            display: block;     /* Ensure it takes its own line */
            max-width: 100%; /* Ensure it doesn't overflow horizontally */
        }


        /* --- Countdown Container Styles (Shared) --- */
        #countdown-container, #closing-countdown-container, #happening-now-container {
            background-color: var(--cal-bg-color); border: 1px solid var(--cal-border-color);
            border-radius: 8px; padding: 12px 15px;
            margin-top: 15px; /* Spacing after calendar or previous timer */
            margin-bottom: 10px; /* Default bottom margin */
            text-align: center; font-size: 1.1em; color: var(--cal-text-color);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        /* Specific margin for the last timer before the H2 */
        /* Apply to closing container OR happening now container if it's visible instead */
        #closing-countdown-container,
        #happening-now-container[style*="display: block"] ~ #closing-countdown-container, /* If happening now is visible, apply margin to closing */
        #happening-now-container:not([style*="display: none"]) { /* If happening now is visible and closing is hidden (shouldn't happen with current JS) */
             margin-bottom: 30px; /* More space before the "MORE ABOUT DAILY VRCHAT" heading */
        }
        /* Ensure default margin if happening now is hidden and closing is shown */
         #happening-now-container[style*="display: none"] ~ #closing-countdown-container {
             margin-bottom: 10px; /* Default bottom margin */
         }


        /* Larger screens */
        @media (min-width: 600px) {
             #countdown-container, #closing-countdown-container, #happening-now-container {
                 padding: 15px 20px;
                 font-size: 1.2em;
            }
        }

        /* Specific Timer Text Styles */
        #countdown-timer { color: var(--cal-secondary-color); font-weight: bold; }
        #countdown-day-label { color: var(--cal-primary-color); font-weight: bold; }
        #closing-countdown-timer { color: var(--cal-primary-color); font-weight: bold; }
        #closing-countdown-day-label { color: var(--cal-primary-color); font-weight: bold; }
        #happening-now-message { color: var(--cal-secondary-color); font-weight: bold; }
        #happening-now-link { color: var(--cal-primary-color); font-weight: bold; text-decoration: underline; }
        #happening-now-link:hover { color: #ff4fa4; } /* Hover color for the link */


        /* Responsive Label/Timer Layout */
        @media (max-width: 480px) {
             /* Make labels stack above timers on small screens */
             .countdown-label, #closing-countdown-label, #happening-now-message { display: block; margin-bottom: 3px; }
             #countdown-timer, #closing-countdown-timer, #happening-now-link { display: block; margin-left: 0; min-width: auto; margin-top: 5px;}
             #happening-now-link { margin-top: 8px; } /* Specific spacing for the link */
        }
        @media (min-width: 480px) {
             /* Keep labels inline with timers on larger screens */
             .countdown-label, #closing-countdown-label, #happening-now-message { display: inline; margin-bottom: 0; }
             #countdown-timer, #closing-countdown-timer, #happening-now-link { display: inline-block; margin-left: 8px; min-width: 150px; }
             #happening-now-link { margin-top: 0; }
        }

        /* ========================================= */
        /* == END CALENDAR STYLES ================== */
        /* ========================================= */
    </style>
</head>
<body>
<div class="container">
    <h1>FISH <span aria-hidden="true">＜＞＜</span> COMMUNITY</h1>
    <p> Structured chaos community ecosystem is made out of multiple communities, each with its own leadership and rules. All communities work together and follow the same principles.</p>

    <div class="video-container">
        <iframe width="560" height="315" src="https://www.youtube.com/embed/plQ24noJR3w?si=oQm9TDtJhSec733t" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    </div>

    <!-- === START MOVED CALENDAR SECTION === -->
    <hr>
    <section aria-labelledby="daily-event-heading"> <!-- Added section wrapper for better context -->
        <!-- START: VRChat Calendar -->
        <div class="calendar-container">
            <div class="calendar-header">
                <button id="cal-prev-month" class="cal-nav-btn" title="Previous Month"><</button>
                <h3 id="cal-month-year">Month Year</h3>
                <button id="cal-next-month" class="cal-nav-btn" title="Next Month">></button>
                <button id="cal-goto-today" class="cal-today-btn" title="Go to Today">Today</button>
            </div>

            <div id="start-day-controls">
                <span class="start-day-label">Week Starts On:</span>
                <button id="cal-start-sun" class="cal-start-day-btn" data-day="0">Sunday</button>
                <button id="cal-start-mon" class="cal-start-day-btn" data-day="1">Monday</button>
            </div>

            <!-- Weekday Header Row -->
            <div class="calendar-weekdays" id="calendar-weekdays">
                <!-- Weekday names generated by JS -->
            </div>

            <!-- Calendar Grid Body -->
            <div class="calendar-body" id="calendar-grid"></div>
        </div>
        <!-- END: VRChat Calendar -->

        <!-- START: Countdown Timer (Modified Label) -->
        <div id="countdown-container">
            <span class="countdown-label">Next Daily VRChat (<span id="countdown-day-label">---</span>) starts at 21:00 UTC in:</span>
            <span id="countdown-timer">Calculating...</span>
        </div>
        <!-- END: Countdown Timer -->

        <!-- START: Closing Countdown Timer (Modified Label + Added Span - NO LONGER INITIALLY HIDDEN) -->
        <!-- ****** REMOVED style="display: none;" FROM THIS DIV ****** -->
        <div id="closing-countdown-container">
            <span id="closing-countdown-label">Daily VRChat (<span id="closing-countdown-day-label">---</span>) instance closes at 23:00 UTC in:</span>
            <span id="closing-countdown-timer">Calculating...</span>
        </div>
        <!-- END: Closing Countdown Timer -->
        <p>Join the fish community's daily VRChat event! Just click the day on the calander and join the instance.</p>
        <p>Moderators will close the instances when the event is over. You're welcome to join the instances before the official start time.</p>
            
        <!-- START: Happening Now Container (NEW, Initially Hidden - controlled by JS) -->
        <div id="happening-now-container" style="display: none;">
            <span id="happening-now-message"></span><br>
            <a id="happening-now-link" href="#" target="_blank" rel="noopener noreferrer">Click here to join the instance</a>
        </div>
        <!-- END: Happening Now Container -->

        <!-- Moved Daily VRChat details here -->
        <h2 id="daily-event-heading">MORE ABOUT DAILY VRCHAT</h2>
            <img src="https://lh3.googleusercontent.com/d/1EaOJeQm_VaXNrTPVGzYxCkLSmwG9E-Qe"
                 alt="Fish Community Image" class="community-image" style="max-width: 300px;" loading="lazy" width="300" height="300">
            <p>Public event that lets people freely express themselves without many restrictions. People are given the freedom to be as chaotic, offensive, and loud as they wish to be.</p>
            <p>The main objective of <b>DAILY VRCHAT</b> is to maintain a public <b><span aria-hidden="true">＜＞＜</span></b> group instance for <b>2 hours</b>, inviting anyone from the internet to join (<a href="https://vrc.group/FISH.9566" target="_blank" rel="noopener noreferrer">https://vrc.group/FISH.9566</a>).</p>
            <p>After the event, everyone will be kicked from the instance</p>
            <h3>THERE ARE 2 RULES!</h3>
            <ul>
                <li>1) NSFW avatars are not allowed.</li>
                <li>2) Crasher avatars are not allowed.</li>
            </ul>
            <p>If you break these rules you will be kicked or banned from joining <b>DAILY VRCHAT</b></p>
            <p>Check the Discord Events channel for more details. A link to the world instance will be posted to #🔥instance-link at the start of the event. (Discord accessible via <a href="http://theziver.com" target="_blank" rel="noopener noreferrer">theziver.com</a>)</p>
            <h3>WARNING!</h3>
            <p class="warning">This daily event is not your safe space. Moderators won't assist you with any hateful, racist, or homophobic behavior. And will only enforce 2 rules, If you get easily emotionally distressed <b>DO NOT GO TO THIS EVENT</b></p>
            <p>VRChat's Terms of Service and Guidelines still apply, and violations could result in your account being banned.</p>
    </section>
    <!-- === END MOVED CALENDAR SECTION === -->

    <hr>

    <section aria-labelledby="meaning-heading">
        <h2 id="meaning-heading">MEANING OF FISH <span aria-hidden="true">＜＞＜</span></h2>
        <!-- Use a valid image path or URL if "images/meaning_of_fish.png" is local -->
        <img src="images/meaning_of_fish.png"
             alt="Image explaining the meaning of FISH ＜＞＜: < represents chaos increase, > represents adding structure, ＜＞＜ symbolizes structured chaos."
             class="meaning-image"
             loading="lazy"
             width="600" height="338">
    </section>

    <hr>

    <section aria-labelledby="principles-heading">
        <h2 id="principles-heading">COMMUNITY PRINCIPLES</h2>
        <ol>
            <li><b>FUN</b>: Don't forget to have fun</li>
            <li><b>COMMON SENSE</b>: Not everything needs a rule, sometimes the best guide is common sense.</li>
            <li><b>STRUCTURED CHAOS</b>: Creativity often comes from chaos. Embrace it, but don't let it control you.</li>
            <li><b>CONFLICT AND CREATIVITY</b>: It's okay to disagree. Conflict can lead to better ideas and innovations.</li>
            <li><b>COMMUNICATION</b>: Resolving conflicts and problems requires respectful communication. It's important to address conflicts and problems as soon as possible and not let them escalate.</li>
            <li><b>INNOVATION</b>: Always look for better ways to do things. Innovation is the key to progress.</li>
            <li><b>HUMILITY</b>: Don't let your ego get in the way. Everyone has something to teach you.</li>
            <li><b>SIMPLICITY</b>: The simplest solution is often the best one. Don't overcomplicate things.</li>
            <li><b>DECENCY</b>: Don't be a degenerate. Treat others with respect and kindness.</li>
            <li><b>OPEN-MINDEDNESS</b>: Be open to new ideas and experiences. They're the best way to learn and grow.</li>
            <li><b>AUTHENTICITY</b>: Don't keep pretending to be someone you're not, it's a waste of energy</li>
            <li><b>SUCCESS AND CREATIVITY</b>: Success and money are important, but they shouldn't limit your creativity. Use them as tools for growth, not as the final goal.</li>
        </ol>
        <p>Human nature is complex. People are different, and not everyone will understand your principles or rules just because they are told to. Good and evil exist, and everyone comes from different cultures with different perspectives. Some people don't speak English or know how to communicate, and some people don't have the mental capacity or knowledge to understand complicated things. It's important to remember that things will never be perfect if humans are involved, so it's important to keep a balance between everything. <span aria-hidden="true">＜＞＜</span></p>
    </section>

    <hr>

    <section class="fish-verified-theme" aria-labelledby="verified-heading">
        <h2 id="verified-heading">FISH VERIFIED COMMUNITIES <span aria-hidden="true">＜＞＜</span></h2>
        <img src="https://lh3.googleusercontent.com/d/1QTCy6DfnU4DCHk36a490xExIgqbjCBM8"
             alt="Fish Community Image" class="community-image" style="max-width: 300px;" loading="lazy" width="300" height="300">
        <p>The FISH VERIFIED verifies communities for the FISH <span aria-hidden="true">＜＞＜</span> COMMUNITY. If a community is fish verified the owner of the verified community will be inside this vrchat group (<a href="https://vrc.group/FISHVE.7823" target="_blank" rel="noopener noreferrer">FISHVE.7823</a>) and will also have the FISH-VERIFIED role on the <span aria-hidden="true">＜＞＜</span> discord server.</p>
        <h3>Criteria for Verification</h3>
        <p>To get your community verified as a <span aria-hidden="true">＜＞＜</span> community, you need to meet the following criteria:</p>
        <ol>
            <li>Your community should contribute significantly to the <span aria-hidden="true">＜＞＜</span> community.</li>
            <li>The community must be managed by a capable person.</li>
            <li>The community must be safe for work (SFW)</li>
            <li>The community should have a clear idea behind it and be active.</li>
        </ol>
        <p>If you believe your community could be fish verified, contact TheZiver on <span aria-hidden="true">＜＞＜</span> discord server at <a href="http://theziver.com" target="_blank" rel="noopener noreferrer">theziver.com</a></p>
        <h3>Benefits of Verification</h3>
        <p>When a community gets verified, they receive:</p>
        <ul>
            <li>Full support from the <span aria-hidden="true">＜＞＜</span> community</li>
            <li>Dedicated text channel on the <span aria-hidden="true">＜＞＜</span> discord server</li>
            <li>Asset for displaying group member count in your vrchat world</li>
            <li>Daily vrchat starter pack access, chance to build your own daily vrchat world</li>
            <li>Owner of fish-verified community receives NOCLIP in all DAILY VRCHAT worlds</li>
        </ul>
        <h3>LIST OF FISH VERIFIED COMMUNITIES</h3>
        <ul>
            <li><b>CHEESE FISH</b> avatar/world update group, makes bunch of meme avatars, Owner is Cunks_Feet<br><b>VRChat Group:</b> <a href="https://vrc.group/CHEESE.1570" target="_blank" rel="noopener noreferrer">https://vrc.group/CHEESE.1570</a></li>
            <li><b>VAPOR FISH</b> nostalgia time capsule, makes nostalgia. Owner is Robaws<br><b>VRChat Group:</b> <a href="https://vrc.group/VAPOR.3451" target="_blank" rel="noopener noreferrer">https://vrc.group/VAPOR.3451</a></li>
            <li><b>GAMBLE FISH</b> casino game world inside vrchat. Owner is _spidget<br><b>VRChat Group:</b> <a href="https://vrc.group/GAMBLE.0958" target="_blank" rel="noopener noreferrer">https://vrc.group/GAMBLE.0958</a><br><b>Discord Server:</b> <a href="https://discord.gg/EZmPDtFAPx" target="_blank" rel="noopener noreferrer">https://discord.gg/EZmPDtFAPx</a></li>
            <li><b>RAT FISH</b> is a avatar/world update group, Owner is Luiswillich<br><b>VRChat Group:</b> <a href="https://vrc.group/RAT.3149" target="_blank" rel="noopener noreferrer">https://vrc.group/RAT.3149</a></li>
            <li><b>The Rusk Shack</b> is a community for people who use rusk avatars, Owner is VerSe10<br><b>VRChat Group:</b> <a href="https://vrc.group/TRUSKS.6089" target="_blank" rel="noopener noreferrer">https://vrc.group/TRUSKS.6089</a><br><b>Discord Server:</b> <a href="https://discord.gg/theruskshack" target="_blank" rel="noopener noreferrer">https://discord.gg/theruskshack</a></li>
            <li><b>AVIFAIR</b> is a Global gaming convention inside VR. Owner is Artholic<br><b>VRChat Group:</b> <a href="https://vrc.group/AVI.9657" target="_blank" rel="noopener noreferrer">https://vrc.group/AVI.9657</a><br><b>Discord Server:</b> <a href="https://discord.gg/P5REVfSVMG" target="_blank" rel="noopener noreferrer">https://discord.gg/P5REVfSVMG</a></li>
            <li><b>Family Friendly Cult</b> is for people who use ukon avatars. Owner is Comedian't<br><b>VRChat Group:</b> <a href="https://vrc.group/FAMILY.3738" target="_blank" rel="noopener noreferrer">https://vrc.group/FAMILY.3738</a><br><b>Discord Server:</b> <a href="https://discord.gg/BFex5YNKuy" target="_blank" rel="noopener noreferrer">https://discord.gg/BFex5YNKuy</a></li>
            <li><b>Portal Media</b> is a VR film studio. Owner is Virtual?<br><b>VRChat Group:</b> <a href="https://vrc.group/PORTAL.0170" target="_blank" rel="noopener noreferrer">https://vrc.group/PORTAL.0170</a><br><b>Discord Server:</b> <a href="https://discord.gg/Z6Xrey7rJw" target="_blank" rel="noopener noreferrer">https://discord.gg/Z6Xrey7rJw</a></li>
        </ul>
     </section>

    <hr>

    <section class="rose-fish-theme" aria-labelledby="rose-heading">
        <h2 id="rose-heading">ROSE FISH COMMUNITY</h2>
        <img src="https://lh3.googleusercontent.com/d/1tAe5dI01yMmozt61OVtyN4b_gTYpJh2g"
             alt="Fish Community Image" class="community-image" style="max-width: 300px;" loading="lazy" width="300" height="300">
        <p><b>DATABASE:</b> <a href="http://rosefish.theziver.com" target="_blank" rel="noopener noreferrer">rosefish.theziver.com</a></p>
        <p>Content creation community that makes content for the FISH <span aria-hidden="true">＜＞＜</span> COMMUNITY. When someone joins rose fish, they get access to exclusive things.</p>
        <h3>Joining ROSE FISH</h3>
        <p>To join rose fish you need to make a contribution that requires human effort to create and could be easily used by the fish community members. For example:</p>
        <ul>
            <li>Public VRChat avatar/world</li><li>3D model</li><li>Script, Code, Utility, Addon, Tool</li><li>Shaders</li><li>Videos/Animations</li><li>Music, Sound Effects (only youtube or google drive links allowed)</li><li>Drawings</li><li>Other content related to <span aria-hidden="true">＜＞＜</span> that requires effort to create.</li>
        </ul>
        <p>If you believe you have made a significant contribution, you can submit it on <span aria-hidden="true">＜＞＜</span> discord server at <a href="http://theziver.com" target="_blank" rel="noopener noreferrer">theziver.com</a></p>
        <p>After submitting a contribution, all the rose fish members will participate in a voting process on discord. To receive a rose fish invitation, the contribution must receive a "YES" vote from over 60％ of the rose fish members.</p>
        <p>We have an avatar world called: "ROSE <span aria-hidden="true">＜＞＜</span> AVATARS" where we distribute our public avatars.</p>
        <p>Please make your contributions presentable and concise and free from any NSFW content. <span aria-hidden="true">＜＞＜</span></p>
        <h3>ROSE FISH AVATAR GUIDELINES</h3>
        <ol>
            <li><b>AVATAR CONTEXT</b>: Avatar context matters, avatars designed with the intention of being sexual, offensive, or malicious are not allowed.</li>
            <li><b>CLOTHING</b>: Avatars can wear skimpy clothing, but it must be used in a non-sexual manner.</li>
            <li><b>GORE</b>: Avatars that show realistic violence or gore are not allowed.</li>
            <li><b>PARODY COMEDY</b>: Avatars that are loud, disruptive, or malicious are allowed if they're created for comedic purposes. This includes avatars with bright colors, flashing images, and performance-heavy shaders.</li>
            <li><b>COPYRIGHT RESPONSIBILITY</b>: By submitting an avatar, users accept the risk of a DMCA strike if they violate intellectual property rights.</li>
        </ol>
    </section>

    <hr>

    <section class="luxury-trash-theme" aria-labelledby="luxury-heading">
        <h2 id="luxury-heading">LUXURY TRASH STORE</h2>
        <img src="https://lh3.googleusercontent.com/d/1Ug-ZoqPJnT3tbvOAVKYW_dBNJH3LdgdI "
             alt="Fish Community Image" class="community-image" style="max-width: 300px;" loading="lazy" width="300" height="300">
        <p><i>"Success and money are important, but they shouldn't limit your creativity. Use them as tools for growth, not as the final goal."</i></p>
        <ul>
            <li>
                <b>LUXURY EGG</b> - ¥ 111<br>
                <a href="https://theziver.booth.pm/items/3780803" target="_blank" rel="noopener noreferrer">https://theziver.booth.pm/items/3780803</a>
            </li>
            <li>
                <b>LUXURY FISH</b> - ¥ 0<br>
                <a href="https://theziver.booth.pm/items/4131078" target="_blank" rel="noopener noreferrer">https://theziver.booth.pm/items/4131078</a>
            </li>
            <li>
                <b>LUXURY STAR</b> - ¥ 111<br>
                <a href="https://theziver.booth.pm/items/4234569" target="_blank" rel="noopener noreferrer">https://theziver.booth.pm/items/4234569</a>
            </li>
            <li>
                <b>LUXURY PRE-CRACKED EGG</b> - ¥ 222<br>
                <a href="https://theziver.booth.pm/items/4678138" target="_blank" rel="noopener noreferrer">https://theziver.booth.pm/items/4678138</a>
            </li>
             <li>
                <b>LUXURY PIPE</b> - ¥ 222<br>
                <a href="https://theziver.booth.pm/items/4993637" target="_blank" rel="noopener noreferrer">https://theziver.booth.pm/items/4993637</a>
            </li>
            <li>
                <b>FISH HAIRCLIP</b> - ¥ 0<br>
                <a href="https://theziver.booth.pm/items/5106312" target="_blank" rel="noopener noreferrer">https://theziver.booth.pm/items/5106312</a>
            </li>
            <li>
                <b>FISHING FLAG (AVATAR PREFAB)</b> - ¥ 777<br>
                <a href="https://theziver.booth.pm/items/5399404" target="_blank" rel="noopener noreferrer">https://theziver.booth.pm/items/5399404</a>
            </li>
            <li>
                <b>LUXURY CUBE</b> - ¥ 1337<br>
                <a href="https://theziver.booth.pm/items/5980910" target="_blank" rel="noopener noreferrer">https://theziver.booth.pm/items/5980910</a>
            </li>
            <li>
                <b>LUXURY TURRET (WORLD PREFAB)</b> - ¥ 999<br>
                <a href="https://theziver.booth.pm/items/6610771" target="_blank" rel="noopener noreferrer">https://theziver.booth.pm/items/6610771</a>
            </li>
        </ul>
    </section>

    <div class="fish-animation" aria-hidden="true">
        <span class="fish-symbol"><</span><span class="fish-symbol">></span><span class="fish-symbol"><</span>
        <span class="fish-symbol"><</span><span class="fish-symbol">></span><span class="fish-symbol"><</span>
        <span class="fish-symbol"><</span><span class="fish-symbol">></span><span class="fish-symbol"><</span>
        <span class="fish-symbol"><</span><span class="fish-symbol">></span><span class="fish-symbol"><</span>
        <span class="fish-symbol"><</span><span class="fish-symbol">></span><span class="fish-symbol"><</span>
        <span class="fish-symbol"><</span><span class="fish-symbol">></span><span class="fish-symbol"><</span>
        <span class="fish-symbol"><</span><span class="fish-symbol">></span><span class="fish-symbol"><</span>
        <span class="fish-symbol"><</span><span class="fish-symbol">></span><span class="fish-symbol"><</span>
        <span class="fish-symbol"><</span><span class="fish-symbol">></span><span class="fish-symbol"><</span>
        <span class="fish-symbol"><</span><span class="fish-symbol">></span><span class="fish-symbol"><</span>
        <span class="fish-symbol"><</span><span class="fish-symbol">></span><span class="fish-symbol"><</span>
        <span class="fish-symbol"><</span><span class="fish-symbol">></span><span class="fish-symbol"><</span>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {

    // --- Calendar Elements ---
    const calendarGrid = document.getElementById('calendar-grid');
    const monthYearDisplay = document.getElementById('cal-month-year');
    const prevMonthButton = document.getElementById('cal-prev-month');
    const nextMonthButton = document.getElementById('cal-next-month');
    const gotoTodayButton = document.getElementById('cal-goto-today');
    const weekdaysContainer = document.getElementById('calendar-weekdays');
    const startSunButton = document.getElementById('cal-start-sun');
    const startMonButton = document.getElementById('cal-start-mon');

    // --- Timer Elements ---
    const countdownContainer = document.getElementById('countdown-container');
    const countdownTimerDisplay = document.getElementById('countdown-timer');
    const countdownDayLabel = document.getElementById('countdown-day-label');

    const closingCountdownContainer = document.getElementById('closing-countdown-container');
    const closingCountdownTimerDisplay = document.getElementById('closing-countdown-timer');
    const closingCountdownDayLabel = document.getElementById('closing-countdown-day-label');

    const happeningNowContainer = document.getElementById('happening-now-container');
    const happeningNowMessage = document.getElementById('happening-now-message');
    const happeningNowLink = document.getElementById('happening-now-link');

    // --- Constants and State ---
    const targetDate = new Date(Date.UTC(2023, 6, 20)); // July 20, 2023 UTC (Month is 0-indexed)
    const today = new Date();
    const todayUTC = new Date(Date.UTC(today.getUTCFullYear(), today.getUTCMonth(), today.getUTCDate()));
    let currentMonth = today.getUTCMonth();
    let currentYear = today.getUTCFullYear();
    let startDayOfWeekSetting = 1; // Default: Monday (0=Sun, 1=Mon)

    // Load saved start day preference
    const savedStartDay = localStorage.getItem('calendarStartDay');
    if (savedStartDay && (savedStartDay === '0' || savedStartDay === '1')) {
        startDayOfWeekSetting = parseInt(savedStartDay, 10);
    }

    // --- Data Arrays ---
    const locations = [ "YES?", "LUXURY TRASH", "The Fishing Mall", "Retrocubic Nexus", "Cunks Coughing City", "YES?", "YES?" ]; // Index 0=Sunday, 1=Monday,...
    const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

    // World IDs mapped to the day of the week (Index 0=Monday, ..., 6=Sunday)
    const WORLD_IDS = {
        0: "wrld_b0812b34-cd7c-44b8-9b29-4f921a9e4d5a",  // Monday
        1: "wrld_9806f25c-0644-4ed7-a3b9-404763bd7dbc",  // Tuesday
        2: "wrld_a1caec89-3313-42d3-977a-3f8ac819a5a9",  // Wednesday
        3: "wrld_94d6eb87-7246-4dd8-81c0-cb1f468f096a",  // Thursday
        4: "wrld_72b30439-62a0-4c0d-a0e6-b3eb7292d355",  // Friday
        5: "wrld_72b30439-62a0-4c0d-a0e6-b3eb7292d355",  // Saturday
        6: "wrld_72b30439-62a0-4c0d-a0e6-b3eb7292d355"   // Sunday
    };
    const VRC_GROUP_ID = "grp_2b910dc4-e984-4fd5-813c-877edcea29d2"; // Fish Group ID

    // Flags for error logging
    window.timerElementsChecked = false;
    window.timerElementsMissing = false;

    // --- Helper Functions ---

    function getOrdinalSuffix(num) {
         if (num === null || typeof num === 'undefined') return "";
         const n = Number(num);
         if (isNaN(n) || n < 0) return "";
        const j = n % 10, k = n % 100;
        if (j == 1 && k != 11) return "st";
        if (j == 2 && k != 12) return "nd";
        if (j == 3 && k != 13) return "rd";
        return "th";
    }

    function calculateDailyVrchatDay(date) {
         const normalizedDate = new Date(Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate()));
         if (normalizedDate < targetDate) return null; // Date is before the first event day
         const oneDay = 24 * 60 * 60 * 1000;
         // Calculate difference in days (0 for the first day, 1 for second, etc.)
         const dayDifference = Math.floor((normalizedDate - targetDate) / oneDay);
         return (dayDifference >= 0) ? dayDifference : null;
    }

    // --- Calendar Rendering Functions ---

    function renderCalendar(month, year) {
        // Check for essential calendar elements
        if (!calendarGrid || !monthYearDisplay || !weekdaysContainer) {
             console.error("Calendar base elements (grid, month/year display, or weekdays container) missing!");
             if(calendarGrid) calendarGrid.innerHTML = "<p style='color: red; text-align: center;'>Error loading calendar grid.</p>";
             return;
        }

        monthYearDisplay.textContent = `${monthNames[month]} ${year}`;

        // Render Weekday Headers
        weekdaysContainer.innerHTML = '';
        const weekdayNamesShort = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"]; // Standard order
        let orderedWeekdays = [];

        if (startDayOfWeekSetting === 1) { // Monday start
            orderedWeekdays = weekdayNamesShort;
        } else { // Sunday start (0)
            orderedWeekdays = [...weekdayNamesShort.slice(6), ...weekdayNamesShort.slice(0, 6)]; // Rotate: Sun, Mon, Tue...
        }

        orderedWeekdays.forEach(dayName => {
            const weekdayCell = document.createElement('div');
            weekdayCell.classList.add('weekday-header');
            weekdayCell.textContent = dayName;
            weekdaysContainer.appendChild(weekdayCell);
        });

        // Render Calendar Grid
        calendarGrid.innerHTML = '';

        const firstDayOfMonth = new Date(Date.UTC(year, month, 1));
        const daysInMonth = new Date(Date.UTC(year, month + 1, 0)).getUTCDate();
        const lastDayOfPrevMonth = new Date(Date.UTC(year, month, 0)).getUTCDate();
        const firstDayIndex = firstDayOfMonth.getUTCDay(); // 0=Sun, 1=Mon,...
        let startingDayOffset = (firstDayIndex - startDayOfWeekSetting + 7) % 7;

        // Previous month's days
        for (let i = 0; i < startingDayOffset; i++) {
            const day = lastDayOfPrevMonth - startingDayOffset + 1 + i;
            calendarGrid.appendChild(createDayCell(day, true));
        }

        // Current month's days
        for (let day = 1; day <= daysInMonth; day++) {
            const cellDate = new Date(Date.UTC(year, month, day));
            const isToday = (year === todayUTC.getUTCFullYear() && month === todayUTC.getUTCMonth() && day === todayUTC.getUTCDate());
            calendarGrid.appendChild(createDayCell(day, false, cellDate, isToday));
        }

        // Next month's days
        const totalCellsRendered = startingDayOffset + daysInMonth;
        const remainingCells = (7 - (totalCellsRendered % 7)) % 7; // Fill remaining grid cells
        for (let i = 0; i < remainingCells; i++) {
            calendarGrid.appendChild(createDayCell(i + 1, true));
        }
    }

    function createDayCell(dayNumber, isOtherMonth, cellDate = null, isToday = false) {
        const dayCell = document.createElement('div');
        dayCell.classList.add('calendar-day');

        const dayNumberSpan = document.createElement('span');
        dayNumberSpan.classList.add('day-number');
        dayNumberSpan.textContent = dayNumber;

        if (isOtherMonth) {
            dayCell.classList.add('other-month');
            dayCell.appendChild(dayNumberSpan);
        } else if (cellDate) {
            const dailyDay = calculateDailyVrchatDay(cellDate); // Get event number for this date

            if (dailyDay !== null) { // If it's a valid event day
                const suffix = getOrdinalSuffix(dailyDay);
                const instanceId = dailyDay; // Use event number as instance ID
                const dayOfWeekForWorld = (cellDate.getUTCDay() + 6) % 7; // Convert UTC day (Sun=0) to Mon=0..Sun=6 index for WORLD_IDS
                const worldId = WORLD_IDS[dayOfWeekForWorld];
                const dayOfWeekForLocation = cellDate.getUTCDay(); // Keep original UTC day for location array (Sun=0..Sat=6)
                const locationName = locations[dayOfWeekForLocation];

                // Construct VRChat launch link
                const baseUrl = "https://vrchat.com/home/launch?worldId=" + worldId + "&instanceId=";
                const instanceParams = `~group(${VRC_GROUP_ID})~groupAccessType(public)~region(eu)`; // Use const for Group ID
                const vrchatLink = baseUrl + instanceId + instanceParams;

                // Create link element to wrap content
                const dayLink = document.createElement('a');
                dayLink.href = vrchatLink;
                dayLink.target = "_blank";
                dayLink.rel = "noopener noreferrer";
                dayLink.title = `Join Daily VRChat #${dailyDay}${suffix}`;

                dayLink.appendChild(dayNumberSpan); // 1. Append Day number

                const eventNumSpan = document.createElement('span'); // 2. Append Event Number (Ordinal)
                eventNumSpan.classList.add('daily-event-num');
                eventNumSpan.textContent = `${dailyDay}${suffix}`;
                dayLink.appendChild(eventNumSpan);

                if (locationName) { // 3. Append Location (if defined)
                    const locationSpan = document.createElement('span');
                    locationSpan.classList.add('event-location');
                    locationSpan.textContent = locationName;
                    dayLink.appendChild(locationSpan);
                }

                dayCell.appendChild(dayLink); // Add the link containing the ordered elements

            } else {
                // Day is in current month but before the first event day
                dayCell.appendChild(dayNumberSpan);
            }

            // Highlight today's date
            if (isToday) {
                dayCell.classList.add('today');
            }
        } else {
             // Fallback (shouldn't happen with current logic)
             dayCell.appendChild(dayNumberSpan);
        }

        return dayCell;
    }

    // --- Combined Timer Update Function (Ensures both timers visible) ---
    function updateEventTimers() {
        // Check if all required timer elements exist (log error only once)
        if (!window.timerElementsChecked) {
            if (!countdownContainer || !countdownTimerDisplay || !countdownDayLabel ||
                !closingCountdownContainer || !closingCountdownTimerDisplay || !closingCountdownDayLabel ||
                !happeningNowContainer || !happeningNowMessage || !happeningNowLink)
            {
                console.error("One or more timer display elements are missing! Timers will not function correctly.");
                 if(countdownContainer) countdownContainer.style.display = 'none';
                 if(closingCountdownContainer) closingCountdownContainer.style.display = 'none';
                 if(happeningNowContainer) happeningNowContainer.style.display = 'none';
                 window.timerElementsMissing = true; // Set flag indicating failure
            }
             window.timerElementsChecked = true; // Mark as checked
        }
        // If elements were missing on the first check, stop
        if (window.timerElementsMissing) return;

        try {
            const nowUTC = new Date();
            const nowUTCMillis = nowUTC.getTime();

            // --- Calculate and Update "Starts In" Countdown ---
            let nextStartUTC = new Date(Date.UTC(nowUTC.getUTCFullYear(), nowUTC.getUTCMonth(), nowUTC.getUTCDate(), 21, 0, 0, 0));
            // If current time is past or exactly at today's 21:00 UTC, target tomorrow's 21:00 UTC
            if (nowUTCMillis >= nextStartUTC.getTime()) {
                nextStartUTC.setUTCDate(nextStartUTC.getUTCDate() + 1);
            }
            const diffToStart = nextStartUTC.getTime() - nowUTCMillis;
            const startDayNumber = calculateDailyVrchatDay(nextStartUTC); // Get event number for the upcoming start
            const startDaySuffix = getOrdinalSuffix(startDayNumber);

            // Update Start Countdown Display
            countdownDayLabel.textContent = (startDayNumber !== null) ? `${startDayNumber}${startDaySuffix}` : "---";
            countdownTimerDisplay.textContent = formatTimeDifference(diffToStart);
            // *** Ensure Starts In timer is ALWAYS visible ***
            countdownContainer.style.display = 'block';


            // --- Calculate and Update "Closes In" Countdown ---
            let nextCloseUTC = new Date(Date.UTC(nowUTC.getUTCFullYear(), nowUTC.getUTCMonth(), nowUTC.getUTCDate(), 23, 0, 0, 0));
             // If current time is past or exactly at today's 23:00 UTC, target tomorrow's 23:00 UTC
            if (nowUTCMillis >= nextCloseUTC.getTime()) {
                nextCloseUTC.setUTCDate(nextCloseUTC.getUTCDate() + 1);
            }
            const diffToClose = nextCloseUTC.getTime() - nowUTCMillis;
            let closeEventDayUTC = new Date(nextCloseUTC);
            closeEventDayUTC.setUTCHours(21, 0, 0, 0); // Find the corresponding start date for this closing time
            const closeDayNumber = calculateDailyVrchatDay(closeEventDayUTC); // Get event number for the event that is closing
            const closeDaySuffix = getOrdinalSuffix(closeDayNumber);

            // Update Close Countdown Display
            closingCountdownDayLabel.textContent = (closeDayNumber !== null) ? `${closeDayNumber}${closeDaySuffix}` : "---";
            closingCountdownTimerDisplay.textContent = formatTimeDifference(diffToClose);
            // *** Ensure Closes In timer is ALWAYS visible ***
            closingCountdownContainer.style.display = 'block';


            // --- Determine "Happening Now" State (Controls Link Visibility) ---
            const todayStartUTC = new Date(Date.UTC(nowUTC.getUTCFullYear(), nowUTC.getUTCMonth(), nowUTC.getUTCDate(), 21, 0, 0, 0));
            const todayCloseUTC = new Date(Date.UTC(nowUTC.getUTCFullYear(), nowUTC.getUTCMonth(), nowUTC.getUTCDate(), 23, 0, 0, 0));

            // Check if current time is strictly within today's 21:00 to 23:00 UTC window
            if (nowUTCMillis >= todayStartUTC.getTime() && nowUTCMillis < todayCloseUTC.getTime()) {
                // Event is currently happening
                const currentDayNumber = calculateDailyVrchatDay(todayStartUTC);
                const currentDaySuffix = getOrdinalSuffix(currentDayNumber);
                const instanceId = currentDayNumber;

                if (instanceId !== null) {
                     // Construct the link for the *currently active* instance
                     const dayOfWeekForWorld = (todayStartUTC.getUTCDay() + 6) % 7;
                     const worldId = WORLD_IDS[dayOfWeekForWorld];
                     const baseUrl = "https://vrchat.com/home/launch?worldId=" + worldId + "&instanceId=";
                     const instanceParams = `~group(${VRC_GROUP_ID})~groupAccessType(public)~region(eu)`;
                     const vrchatLink = baseUrl + instanceId + instanceParams;

                     // Update and show the "Happening Now" container
                     happeningNowMessage.textContent = `DAILY VRCHAT (${currentDayNumber}${currentDaySuffix}) IS CURRENTLY HAPPENING`;
                     happeningNowLink.href = vrchatLink;
                     happeningNowContainer.style.display = 'block'; // SHOW the link container
                } else {
                     // Error state: hide the link container if instance ID calculation fails
                     happeningNowContainer.style.display = 'none';
                     console.error("Could not calculate instance ID during event window.");
                }
            } else {
                // Event is not happening right now
                happeningNowContainer.style.display = 'none'; // HIDE the link container
            }

        } catch (error) {
            console.error("Error in updateEventTimers:", error);
            // Modify error state to ensure main timers remain visible if possible
            displayErrorState("Error updating timers.");
        }
    }

    // --- Helper to format time difference (e.g., "01h 05m 30s") ---
    function formatTimeDifference(differenceMillis) {
        if (differenceMillis <= 0) {
            // This state might appear momentarily at the exact transition time
            return "Now / Very Soon!";
        }
        const totalSeconds = Math.max(0, Math.floor(differenceMillis / 1000)); // Ensure non-negative seconds
        const days = Math.floor(totalSeconds / (60 * 60 * 24));
        const hours = Math.floor((totalSeconds % (60 * 60 * 24)) / (60 * 60));
        const minutes = Math.floor((totalSeconds % (60 * 60)) / 60);
        const seconds = totalSeconds % 60;

        let timeString = "";
        if (days > 0) { timeString += `${days}d `; } // Include days part only if > 0
        // Always show H, M, S, padded with leading zeros
        timeString += `${String(hours).padStart(2, '0')}h ${String(minutes).padStart(2, '0')}m ${String(seconds).padStart(2, '0')}s`;
        return timeString.trim();
    }

    // --- Helper to display errors consistently (Ensures timers remain visible) ---
    function displayErrorState(message) {
         console.error(message); // Log detailed error to console
         // Attempt to show a user-friendly error state in the UI, keeping containers visible
         if (countdownContainer) {
             countdownContainer.style.display = 'block'; // Keep visible
             if (countdownDayLabel) countdownDayLabel.textContent = "Err";
             if (countdownTimerDisplay) countdownTimerDisplay.textContent = "Error";
         }
         if (closingCountdownContainer) {
             closingCountdownContainer.style.display = 'block'; // Keep visible
             if (closingCountdownDayLabel) closingCountdownDayLabel.textContent = "Err";
             if (closingCountdownTimerDisplay) closingCountdownTimerDisplay.textContent = "Error";
         }
         // Ensure link is hidden on error
         if (happeningNowContainer) happeningNowContainer.style.display = 'none';
    }

    // --- Calendar Navigation Functions ---
    function goToPrevMonth() { currentMonth--; if (currentMonth < 0) { currentMonth = 11; currentYear--; } renderCalendar(currentMonth, currentYear); }
    function goToNextMonth() { currentMonth++; if (currentMonth > 11) { currentMonth = 0; currentYear++; } renderCalendar(currentMonth, currentYear); }
    function goToToday() { const now = new Date(); if (currentMonth !== now.getUTCMonth() || currentYear !== now.getUTCFullYear()) { currentMonth = now.getUTCMonth(); currentYear = now.getUTCFullYear(); renderCalendar(currentMonth, currentYear); } }

    // --- Start Day Setting Function ---
    function updateStartDaySelection(newStartDay) {
        if (startDayOfWeekSetting === newStartDay) return; // No change needed
        startDayOfWeekSetting = newStartDay;
        localStorage.setItem('calendarStartDay', newStartDay.toString()); // Save preference

        // Update button visuals if they exist
        if (startSunButton) startSunButton.classList.toggle('active', newStartDay === 0);
        if (startMonButton) startMonButton.classList.toggle('active', newStartDay === 1);

        // Re-render calendar with new setting
        renderCalendar(currentMonth, currentYear);
    }

    // --- Event Listeners ---
    // Add listeners only if the buttons exist to prevent errors
    if (prevMonthButton) prevMonthButton.addEventListener('click', goToPrevMonth); else console.warn("Previous month button not found.");
    if (nextMonthButton) nextMonthButton.addEventListener('click', goToNextMonth); else console.warn("Next month button not found.");
    if (gotoTodayButton) gotoTodayButton.addEventListener('click', goToToday); else console.warn("Go to Today button not found.");
    if (startSunButton) startSunButton.addEventListener('click', () => updateStartDaySelection(0)); else console.warn("Start Sunday button not found.");
    if (startMonButton) startMonButton.addEventListener('click', () => updateStartDaySelection(1)); else console.warn("Start Monday button not found.");

    // --- Initial Setup ---
    // Check essential *calendar* elements first to ensure base functionality
    if (!calendarGrid || !monthYearDisplay || !startSunButton || !startMonButton || !weekdaysContainer) {
         console.error("One or more essential elements for calendar initialization are missing! Calendar will not render.");
         // Display user-facing error related to calendar init failure
         const container = document.querySelector('.container') || document.body;
         if (container && !document.getElementById('init-error-msg')) { // Prevent multiple messages
            const errorMsg = document.createElement('p');
            errorMsg.id = 'init-error-msg';
            errorMsg.style.color = 'red';
            errorMsg.style.fontWeight = 'bold';
            errorMsg.style.textAlign = 'center';
            errorMsg.style.marginTop = '20px';
            errorMsg.textContent = 'Error: Failed to initialize the calendar component. Please check the browser console for details.';
            const calendarSection = document.querySelector('section[aria-labelledby="daily-event-heading"]');
            if (calendarSection) {
                calendarSection.parentNode.insertBefore(errorMsg, calendarSection);
            } else {
                container.insertBefore(errorMsg, container.firstChild);
            }
         }
         // Do not proceed if calendar can't initialize
         return;
    }

    // Set initial active state for start day buttons based on loaded preference
    startSunButton.classList.toggle('active', startDayOfWeekSetting === 0);
    startMonButton.classList.toggle('active', startDayOfWeekSetting === 1);

    // Initial render of the calendar and start the timer loop
    renderCalendar(currentMonth, currentYear);
    updateEventTimers(); // Run the timer logic once immediately on load
    setInterval(updateEventTimers, 1000); // Update the timers every second

}); // End DOMContentLoaded wrapper
</script>

</body>
</html>